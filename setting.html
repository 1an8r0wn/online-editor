<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="./app.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/store@2.0.12/dist/store.legacy.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>
    <title>Doc LIST | online text editor</title>
</head>

<body>
    <div class="max-w-screen-sm mx-auto min-h-screen p-1">
        <div class="py-2 flex items-center justify-between sticky top-0 bg-white">
            <a href="/doclist.html" class="btn btn-outline btn-sm">
                back
            </a>
            <div>
                <button id="save-btn" class="btn btn-primary btn-sm">
                    save
                </button>
            </div>
        </div>
        <div id="more" class="bg-green-50 p-4 text-2xs  ">
            <div>
                <div>Editable URL:
                    <span id="editable-url"></span>
                </div>
            </div>
            <div class="mt-2">
                <div>ViewOnly URL:
                    <span id="view-url"></span>
                </div>
            </div>
        </div>
        <input id="doc-title" placeholder="set title to support search" class="border border-gray-200   w-full
            bg-gray-50 text-sm p-2 mt-2 text-black focus:outline-none"></input>

        <input id="doc-password" placeholder="set password to keep save" class="border border-gray-200   w-full
            bg-gray-50 text-sm p-2 mt-2 text-black focus:outline-none"></input>
    </div>
    <script>
        let id = new URLSearchParams(location.search).get('id');
        let $title = $('#doc-title');
        let $saveBtn = $('#save-btn')
        $saveBtn.on('click', function () {
            if ($saveBtn.hasClass('loading')) {
                return
            };
            // $saveBtn.addClass('loading');
            $.post('/api/doc-set-title', { id: id, title: $title.val(), password: $('#doc-password').val() }, function (data) {
                $saveBtn.removeClass('loading');
            })
        });
        $(function () {
            $saveBtn.addClass('loading').text('')
            $.get('/api/doc-get?id=' + id, function (doc) {
                $('#editable-url').text('https://doc.op52.com/doc.html?id=' + doc.id)
                $('#view-url').text('https://doc.op52.com/doc.html?vid=' + doc.vid)
                $saveBtn.removeClass('loading').text('save')
                $title.val(doc.title);
            })
        });
    </script>
</body>

</html>